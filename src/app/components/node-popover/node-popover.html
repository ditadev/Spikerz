@if (popoverData()) {
    <div class="bg-white rounded-[15px] shadow-sm p-[30px]">
      <h2 class="text-xl font-bold text-emerald-600 mb-6">Lorem Ipsum Dolor Sit</h2>
  
      <div class="flex gap-5">
        <!-- Left Column: Asset List (367px width) -->
        <div class="w-[367px] border border-gray-200 rounded-[15px] overflow-hidden">
          <div class="p-[30px]">
            <!-- Headers -->
            <div class="flex items-center justify-between mb-6">
              <h3 class="text-sm font-semibold text-gray-600">Asset</h3>
              <h3 class="text-sm font-semibold text-gray-600">Contextual Risk</h3>
            </div>
            
            <!-- Asset Items -->
            <div class="space-y-3">
              @for (asset of paginatedAssets; track asset.id) {
                <div class="flex items-center justify-between p-3 bg-gray-50 rounded-lg hover:bg-gray-100 transition-colors">
                  <div class="flex items-center gap-3 flex-1 min-w-0">
                    <div class="w-10 h-10 bg-blue-100 rounded-lg flex items-center justify-center flex-shrink-0">
                      <span class="text-blue-600 text-lg">ðŸ’»</span>
                    </div>
                    <div class="min-w-0 flex-1">
                      <div class="text-sm font-medium text-gray-900 truncate">{{ asset.name }}</div>
                      <div class="text-xs text-gray-500">{{ asset.ipAddress }}</div>
                    </div>
                  </div>
                  <span [ngClass]="{
                    'bg-red-100 text-red-600': asset.riskLevel === 'Critical',
                    'bg-orange-100 text-orange-600': asset.riskLevel === 'High',
                    'bg-yellow-100 text-yellow-600': asset.riskLevel === 'Medium',
                    'bg-emerald-100 text-emerald-600': asset.riskLevel === 'Low'
                  }" class="px-4 py-1 text-xs font-semibold rounded-full ml-3 whitespace-nowrap">
                    {{ asset.riskLevel }}
                  </span>
                </div>
              }
            </div>
  
            <!-- Pagination -->
            <div class="flex items-center justify-center gap-4 text-sm text-gray-600 pt-6 mt-6 border-t border-gray-100">
              <button 
                (click)="prevPage()"
                [disabled]="currentPage() === 1"
                [class.opacity-30]="currentPage() === 1"
                [class.cursor-not-allowed]="currentPage() === 1"
                class="hover:text-gray-900 transition-colors text-xl font-light"
              >
                â€¹
              </button>
              <span class="text-xs">
                Showing {{ (currentPage() - 1) * pageSize + 1 }}-{{ Math.min(currentPage() * pageSize, popoverData()!.details.assets.length) }} of {{ popoverData()!.details.assets.length }}
              </span>
              <button 
                (click)="nextPage()"
                [disabled]="currentPage() === totalPages"
                [class.opacity-30]="currentPage() === totalPages"
                [class.cursor-not-allowed]="currentPage() === totalPages"
                class="hover:text-gray-900 transition-colors text-xl font-light"
              >
                â€º
              </button>
            </div>
          </div>
        </div>
  
        <!-- Right Column: Risk Summary (340px width) -->
        <div class="w-[340px] border border-gray-200 rounded-[15px] p-[30px]">
          <h3 class="text-sm font-semibold text-gray-600 mb-6">Contextual Risk</h3>
          
          <!-- Flex container with flex-row to force horizontal layout -->
          <div class="flex flex-row items-start gap-6">
            <!-- Risk Legend - Left side -->
            <div class="space-y-3 flex-shrink-0">
              <div class="flex items-center gap-3">
                <div class="w-3 h-3 rounded-full bg-red-500 flex-shrink-0"></div>
                <span class="text-sm text-gray-700 whitespace-nowrap">{{ popoverData()!.details.riskSummary.critical }} Critical</span>
              </div>
              <div class="flex items-center gap-3">
                <div class="w-3 h-3 rounded-full bg-orange-500 flex-shrink-0"></div>
                <span class="text-sm text-gray-700 whitespace-nowrap">{{ popoverData()!.details.riskSummary.high }} High</span>
              </div>
              <div class="flex items-center gap-3">
                <div class="w-3 h-3 rounded-full bg-yellow-500 flex-shrink-0"></div>
                <span class="text-sm text-gray-700 whitespace-nowrap">{{ popoverData()!.details.riskSummary.medium }} Medium</span>
              </div>
              <div class="flex items-center gap-3">
                <div class="w-3 h-3 rounded-full bg-emerald-500 flex-shrink-0"></div>
                <span class="text-sm text-gray-700 whitespace-nowrap">{{ popoverData()!.details.riskSummary.low }} Low</span>
              </div>
            </div>
  
            <!-- Donut Chart - Right side -->
            <div class="flex-shrink-0">
              <div class="relative w-32 h-32">
                <svg viewBox="0 0 120 120" class="transform -rotate-90 w-full h-full">
                  <!-- Background circle -->
                  <circle
                    cx="60"
                    cy="60"
                    r="45"
                    fill="none"
                    stroke="#F3F4F6"
                    stroke-width="14"
                  />
                  
                  <!-- Animated critical risk circle -->
                  <circle
                    cx="60"
                    cy="60"
                    r="45"
                    fill="none"
                    stroke="#EF4444"
                    stroke-width="14"
                    [attr.stroke-dasharray]="getCircumference()"
                    [attr.stroke-dashoffset]="getDashOffset()"
                    stroke-linecap="round"
                    class="donut-segment"
                  />
                </svg>
                
                <!-- Center number -->
                <div class="absolute inset-0 flex flex-col items-center justify-center">
                  <span class="text-3xl font-bold text-gray-900">{{ popoverData()!.details.riskSummary.critical }}</span>
                </div>
              </div>
            </div>
          </div>
        </div>
      </div>
    </div>
  }