@if (popoverData()) {
  <div class="w-full">
    <h2 style="font-family: 'Public Sans', sans-serif; font-size: 20px; line-height: 22px; font-weight: 700; letter-spacing: var(--letter-spacing-1-percent, 0.01em); text-transform: capitalize; color: var(--color-success, #02983E); margin-bottom: 24px;">Lorem Ipsum Dolor Sit</h2>

    <div class="flex flex-col lg:flex-row gap-4 md:gap-5 max-w-[727px] mx-auto">
      <div class="overflow-hidden" style="flex: 0 0 367px; border-radius: 15px; border: 1px solid var(--color-gray-soft-50, #F0F1F3); background: #FFFFFF; box-shadow: var(--shadow-card-sm, 0px 1px 3px 0px rgba(0, 0, 0, 0.05), 0px 1px 2px 0px rgba(0, 0, 0, 0.10));">
        <div class="px-6 md:px-8 pt-6 md:pt-8 pb-3" style="border-bottom: 1px solid var(--color-gray-soft-50, #F0F1F3);">
          <div class="flex items-center justify-between">
            <h3 style="font-family: 'Public Sans', sans-serif; font-size: 13px; line-height: 18px; font-weight: 400; letter-spacing: var(--letter-spacing-400, 0.4px); color: var(--color-gray-soft-400, #858D9D);">Asset</h3>
            <h3 style="font-family: 'Public Sans', sans-serif; font-size: 13px; line-height: 18px; font-weight: 400; letter-spacing: var(--letter-spacing-400, 0.4px); color: var(--color-gray-soft-400, #858D9D);">Contextual Risk</h3>
          </div>
        </div>
          
        <div style="border-color: var(--color-gray-soft-50, #F0F1F3);" class="divide-y">
          @for (asset of paginatedAssets(); track asset.id) {
            <div class="flex items-center justify-between px-6 md:px-8 py-3 hover:bg-gray-50 transition-colors gap-3">
              <div class="flex items-center gap-3 flex-1 min-w-0">
                <img 
                  src="assets/icons/server.svg" 
                  alt="server" 
                  style="width: 45px; height: 45px; min-width: 45px; min-height: 45px;"
                  class="flex-shrink-0">
                <div class="min-w-0 flex-1 overflow-hidden">
                  <div class="truncate" style="font-family: 'Public Sans', sans-serif; font-size: 13px; line-height: 13.5px; font-weight: 600; letter-spacing: 0px; text-transform: capitalize; color: var(--color-gray-soft-700, #525D73);">
                    {{ asset.name }}
                  </div>
                  <div class="truncate" style="font-family: 'Public Sans', sans-serif; font-size: 9.45px; line-height: 10.13px; font-weight: 500; letter-spacing: 0px; color: var(--color-gray-soft-500, #667085); margin-top: 4px;">
                    {{ asset.ipAddress }}
                  </div>
                </div>
              </div>
              <span [ngClass]="{
                'bg-red-100 text-red-600': asset.riskLevel === 'Critical',
                'bg-orange-100 text-orange-600': asset.riskLevel === 'High',
                'bg-yellow-100 text-yellow-600': asset.riskLevel === 'Medium',
                'bg-emerald-100 text-emerald-600': asset.riskLevel === 'Low'
              }" style="font-family: 'Public Sans', sans-serif; font-size: 15px; line-height: 22px; font-weight: 700; letter-spacing: var(--letter-spacing-1-percent, 0.01em); text-transform: capitalize;" class="px-3 py-1 rounded-full whitespace-nowrap flex-shrink-0">
                {{ asset.riskLevel }}
              </span>
            </div>
          }
        </div>

        <div class="flex items-center justify-center gap-4 px-6 md:px-8 py-3" style="border-top: 1px solid var(--color-gray-soft-50, #F0F1F3); color: var(--color-gray-soft-500, #667085);">
          <button 
            type="button"
            (click)="prevPage()"
            [disabled]="currentPage() === 1"
            class="pagination-btn"
            [class.disabled]="currentPage() === 1">
            ‹
          </button>
          <span style="font-family: 'Public Sans', sans-serif; font-size: 12px;">
            Showing {{ (currentPage() - 1) * pageSize + 1 }}-{{ Math.min(currentPage() * pageSize, popoverData()!.details.assets.length) }} of {{ popoverData()!.details.assets.length }}
          </span>
          <button 
            type="button"
            (click)="nextPage()"
            [disabled]="currentPage() === totalPages()"
            class="pagination-btn"
            [class.disabled]="currentPage() === totalPages()">
            ›
          </button>
        </div>
      </div>

      <div style="flex: 0 0 340px; border-radius: 20px; border: 1.1px solid var(--color-gray-soft-50, #F0F1F3); background: #FFFFFF; box-shadow: var(--shadow-card-md, 0px 2.9px 4px 0px rgba(0, 0, 0, 0.05)); padding: 30px;">
        <h3 style="font-family: 'Public Sans', sans-serif; font-size: 18px; line-height: 28px; font-weight: 500; letter-spacing: 0px; color: var(--color-gray-soft-500, #667085); margin-bottom: 20px; width: 133px; height: 28px;">Contextual Risk</h3>
        
        <div class="flex flex-col items-center md:flex-row md:items-start md:justify-between gap-4 md:gap-6">
          <div class="flex flex-col justify-between flex-shrink-0" style="min-height: 166px;">
            <div class="flex items-center gap-3">
              <div class="w-3 h-3 rounded-full flex-shrink-0" style="background: var(--color-critical-dark, #C6190D);"></div>
              <span style="font-family: 'Inter', sans-serif; font-size: 15px; line-height: 100%; letter-spacing: 0%; text-transform: capitalize; color: #383874;">
                <span style="font-weight: 700;">{{ currentPageRiskSummary().critical }}</span><span style="font-weight: 400;"> Critical</span>
              </span>
            </div>
            <div class="flex items-center gap-3">
              <div class="w-3 h-3 rounded-full flex-shrink-0" style="background: var(--color-warning, #FF9500);"></div>
              <span style="font-family: 'Inter', sans-serif; font-size: 15px; line-height: 100%; letter-spacing: 0%; text-transform: capitalize; color: #383874;">
                <span style="font-weight: 700;">{{ currentPageRiskSummary().high }}</span><span style="font-weight: 400;"> High</span>
              </span>
            </div>
            <div class="flex items-center gap-3">
              <div class="w-3 h-3 rounded-full bg-yellow-500 flex-shrink-0"></div>
              <span style="font-family: 'Inter', sans-serif; font-size: 15px; line-height: 100%; letter-spacing: 0%; text-transform: capitalize; color: #383874;">
                <span style="font-weight: 700;">{{ currentPageRiskSummary().medium }}</span><span style="font-weight: 400;"> Medium</span>
              </span>
            </div>
            <div class="flex items-center gap-3">
              <div class="w-3 h-3 rounded-full flex-shrink-0" style="background: var(--color-success, #02983E);"></div>
              <span style="font-family: 'Inter', sans-serif; font-size: 15px; line-height: 100%; letter-spacing: 0%; text-transform: capitalize; color: #383874;">
                <span style="font-weight: 700;">{{ currentPageRiskSummary().low }}</span><span style="font-weight: 400;"> Low</span>
              </span>
            </div>
          </div>
      
          <div class="flex-shrink-0">
            <div class="relative w-28 h-28 sm:w-32 sm:h-32 lg:w-36 lg:h-36 xl:w-40 xl:h-40">
              <svg viewBox="0 0 120 120" class="transform -rotate-90 w-full h-full">
                <!-- Background circle -->
                <circle
                  cx="60"
                  cy="60"
                  r="50"
                  fill="none"
                  stroke="#F3F4F6"
                  stroke-width="10"
                />
                
                <!-- Critical segment (red) -->
                @if (currentPageRiskSummary().critical > 0) {
                  <circle
                    cx="60"
                    cy="60"
                    r="50"
                    fill="none"
                    stroke="var(--color-critical-dark, #C6190D)"
                    stroke-width="10"
                    [attr.stroke-dasharray]="getCriticalDashArray()"
                    [attr.stroke-dashoffset]="getCriticalDashOffset()"
                    stroke-linecap="butt"
                    class="donut-segment"
                  />
                }
                
                <!-- High segment (orange) -->
                @if (currentPageRiskSummary().high > 0) {
                  <circle
                    cx="60"
                    cy="60"
                    r="50"
                    fill="none"
                    stroke="var(--color-warning, #FF9500)"
                    stroke-width="10"
                    [attr.stroke-dasharray]="getHighDashArray()"
                    [attr.stroke-dashoffset]="getHighDashOffset()"
                    stroke-linecap="butt"
                    class="donut-segment"
                  />
                }
                
                <!-- Medium segment (yellow) -->
                @if (currentPageRiskSummary().medium > 0) {
                  <circle
                    cx="60"
                    cy="60"
                    r="50"
                    fill="none"
                    stroke="#EAB308"
                    stroke-width="10"
                    [attr.stroke-dasharray]="getMediumDashArray()"
                    [attr.stroke-dashoffset]="getMediumDashOffset()"
                    stroke-linecap="butt"
                    class="donut-segment"
                  />
                }
                
                <!-- Low segment (green) -->
                @if (currentPageRiskSummary().low > 0) {
                  <circle
                    cx="60"
                    cy="60"
                    r="50"
                    fill="none"
                    stroke="var(--color-success, #02983E)"
                    stroke-width="10"
                    [attr.stroke-dasharray]="getLowDashArray()"
                    [attr.stroke-dashoffset]="getLowDashOffset()"
                    stroke-linecap="butt"
                    class="donut-segment"
                  />
                }
              </svg>
              
              <div class="absolute inset-0 flex flex-col items-center justify-center">
                <span class="text-2xl sm:text-3xl lg:text-4xl xl:text-5xl" style="font-family: 'Public Sans', sans-serif; line-height: 28px; font-weight: 600; color: #656575;">{{ currentPageRiskSummary().critical }}</span>
              </div>
            </div>
          </div>
        </div>
      </div>
    </div>
  </div>
}